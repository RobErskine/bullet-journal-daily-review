<script setup>
  import { EnvelopeIcon, LanguageIcon } from '@heroicons/vue/20/solid'
</script>

<script>
export default {
  // data() {
  //   return {
  //     form: {
  //       formName: "",
  //       email: "",
  //       message: "",
  //     },
  //   };
  // },
  methods: {
    currentDate() {
      const current = new Date();
      const date = `${current.getFullYear()}-${current.getMonth()+1}-${current.getDate()}`;
      return date;
    },
    encode(data) {
      return Object.keys(data)
        .map(
          (key) =>
            encodeURIComponent(key) + "=" + encodeURIComponent(data[key])
        )
        .join("&");
    },
    handleSubmit() {
      fetch("/", {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: this.encode({
          'form-name': 'bullet-journal',
          'date': document.getElementById('date').value,
          'numberreview': document.getElementById('numberreview').value,
          'language': document.getElementsByName('language')[0].value,
          'exercise': document.getElementsByName('exercise')[0].value,
          'friends': document.getElementsByName('friends')[0].value,
          'personalproject': document.getElementsByName('personalproject')[0].value,
          'learn': document.getElementsByName('learn')[0].value,
          'review': document.getElementById('numberreview').value,
        })
      }).then(() => { alert('success!') }).catch((error) => alert(error));
    }
  }
}
</script>

<template>
  <main class="p-4 w-full">
    <form id="daily-review" data-netlify="true" method="POST" netlify name="bullet-journal" @submit.prevent="handleSubmit()">
      <div>
        <input id="date" type="hidden" name="date" :value=currentDate() >
        
        <div>
          <h1 class="text-3xl text-center font-bold">
            Daily Review
          </h1>
        </div>

        <div class="block py-2">
          <label for="numberreview" class="block text-sm font-medium text-gray-700 mb-2">How was your day?</label>
          <input type="tel" name="numberreview" id="numberreview" class="block p-2 text-center w-full rounded-md border-2 border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" aria-describedby="numberreview-description">
          <p class="mt-1 text-sm text-gray-500" id="numberreview-description">Use a 1-10 scale. 10 Being a great day!</p>
        </div>
        
        <ToggleItem title="ðŸ‡«ðŸ‡· Practice French?" description="Avez-vous Ã©tudiÃ© le franÃ§ais aujourd'hui? C'est en forgeant qu'on devient forgeron!" name="language" />
      
        <ToggleItem title="ðŸ’ª Get some exercise?" description="Don't gotta be super buff but you can't have a beer gut either. Get your heart rate up today?" name="exercise" />

        <ToggleItem title="ðŸ‘¬ Hang with friends?" description="Gettin' older makes it harder to meet new friends. Did you talk to another friendly soul?" name="friends" />

        <ToggleItem title="ðŸŽ¢ Jam on a personal project?" description="Nothing like building something with your own hands. Make some time to make something for fun?" name="personalproject" />

        <ToggleItem title="ðŸ’¡ Learn something new?" description="Stagnation is death! Keep your mind sharp! Did you get spend time flex a new skill?" name="learn" />

        <div>
          <label for="review" class="block mt-4 text-sm font-medium text-gray-700">Want to expand on anything?</label>
          <div class="mt-1">
            <textarea rows="3" name="review" id="review" class="block p-2 border-2 w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" />
          </div>
        </div>

        <div class="flex w-full align-items-end justify-end">
          <button type="submit" class="inline-flex items-center mt-4 rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
            <EnvelopeIcon class="-ml-1 mr-3 h-5 w-5" aria-hidden="true" />
            Submit daily review
          </button>
        </div>
      </div>
    </form>
  </main>
</template>